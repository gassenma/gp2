---
title: "stacked_model"
author: "Gino Assenmacher, Nathan Koenig, Johanna Langemeyer, Lukas Resch, Ben Roemer"
date: "2022-11-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Get separate data
spotify <- read.csv("spotify")
lr_predictions <- read.csv("lr_predictions.csv")
ann_predictions <- read.csv("ann_predictions.csv")
knn_predictions <- read.csv("knn_predictions.csv")
svm_predictions <- read.csv("svm_predicitions.csv")
dt_predictions <- read.csv("dt_predictions.csv")

# Combine the data
combined_data <- data.frame(lr_predictions, ann_predictions, knn_predictions, svm_predictions, dt_predictions, spotify$target)

# Change dataframe labels
colnames(combined_data) <- c('LR','ANN','KNN', 'SVM', 'DT', 'Actual')
combined_data

# Get data we'll use to test the stacked model on
TODO
```


## Create Stacked Model

```{r}
# Get combined data
full_predictions <- read.csv("full_predictions.csv")

# Build the decision tree
library(caret)
set.seed(300)
fitControl <- trainControl(method = "cv", number = 10)
stacked_mod <- train(form = as.factor(target) ~ ., data = full_predictions, trControl = fitControl, method = "C5.0")
stacked_mod

# Obtain predictions
stacked_predictions <- predict(stacked_mod, full_predictions, type = "raw")
stacked_predictions

# Evaluate model
confusionMatrix(as.factor(stacked_predictions), as.factor(stacked_data$target), positive = "1")
```



