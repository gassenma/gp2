---
title: "lr_file"
author: "Gino Assenmacher, Nathan Koenig, Johanna Langemeyer, Lukas Resch, Ben Roemer"
date: "2022-11-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Get data
spotify_norm <- read.csv("spotify_norm.csv")
spotify_norm <- subset(spotify_norm, select = -X.Intercept.)
spotify_norm
```


```{r}
library(caret)
set.seed(300)
fitControl <- trainControl(method = "cv", number = 10)
lr_mod <- train(form = as.factor(target) ~ ., data = spotify_norm, trControl = fitControl, method = "glm", family = "binomial")
lr_mod
#summary(mod)

# Obtain predictions
lr_predictions <- predict(lr_mod, spotify_norm, type = "raw")
lr_predictions

# Write predictions to CSV
write.csv(spotify, "C:/Users/gasse/Documents/School/to414/gp2/lr_predictions.csv", row.names = FALSE)

# Evaluate model
confusionMatrix(as.factor(lr_predictions), as.factor(spotify_norm$target), positive = "1")
```

